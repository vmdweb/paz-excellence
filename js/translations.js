const translations = {
    en: {
        // Public site
        selectTrack: 'Select a track',
        playlist: 'Playlist',
        catalog: 'Catalog',
        shows: 'Shows',
        upload: 'Upload',
        close: 'Close',
        aToZ: 'A–Z',
        contact: 'Contact',
        contactMessage: 'For collaborations, licensing or professional inquiries, reach us at',
        heroQuote: 'Curating the finest electronic sounds',
        nowPlaying: 'NOW PLAYING',
        
        // Upload form
        uploadTrack: 'Upload Track',
        trackTitle: 'Track Title',
        artist: 'Artist',
        featArtist: 'Feat. Artist',
        country: 'Country',
        coverImage: 'Cover Image',
        audioFile: 'Audio File (MP3)',
        chooseImage: 'Choose Image',
        chooseAudio: 'Choose Audio',
        enterTrackTitle: 'Enter track title',
        artistName: 'Artist name',
        optional: 'Optional',
        selectCountry: 'Select country',
        uploadTrackBtn: 'Upload Track',
        
        // Errors
        titleRequired: 'Title is required',
        artistRequired: 'Artist is required',
        countryRequired: 'Country is required',
        coverRequired: 'Cover image is required',
        audioRequired: 'Audio file is required',
        selectImageFile: 'Please select an image file',
        selectAudioFile: 'Please select an audio file',
        
        // Catalog
        noTracksAvailable: 'No tracks available',
        
        // Shows
        upcoming: 'Upcoming',
        past: 'Past',
        noShowsScheduled: 'No shows scheduled',
        
        // Dashboard
        dashboardAccess: 'Dashboard Access',
        enterPassword: 'Enter password',
        enter: 'Enter',
        incorrectPassword: 'Incorrect password',
        dashboard: 'Dashboard',
        uploadTracks: 'Upload Tracks',
        manageCatalog: 'Manage Catalog',
        showsCalendar: 'Shows Calendar',
        tracks: 'tracks',
        track: 'track',
        shows: 'Shows',
        show: 'show',
        refresh: 'Refresh',
        edit: 'Edit',
        delete: 'Delete',
        saveChanges: 'Save Changes',
        cancel: 'Cancel',
        addShow: 'Add Show',
        date: 'Date',
        city: 'City',
        venue: 'Venue',
        link: 'Link (Optional)',
        enterCity: 'Enter city',
        enterVenue: 'Enter venue name',
        addShowBtn: 'Add Show',
        deleteShow: 'Delete show',
        showDeleted: 'Show deleted successfully',
        showAdded: 'Show added successfully',
        trackUploaded: 'Track uploaded successfully',
        trackDeleted: 'Track deleted successfully',
        trackUpdated: 'Track updated successfully',
        pleaseFillRequired: 'Please fill in all required fields',
        trackNotFound: 'Track not found',
        errorSaving: 'Error saving track. localStorage may be full.',
        errorDeleting: 'Error deleting track',
        errorUpdating: 'Error updating track',
        errorLoading: 'Error loading tracks',
        noTracks: 'No tracks available',
        loadingTracks: 'Loading tracks...',
        loadingShows: 'Loading shows...',
        errorLoadingShows: 'Error loading shows',
        noShows: 'No shows scheduled',
        coverPreview: 'Cover Preview',
        changeImage: 'Change Image'
    },
    pt: {
        // Public site
        selectTrack: 'Selecione uma faixa',
        playlist: 'Playlist',
        catalog: 'Catálogo',
        shows: 'Shows',
        upload: 'Enviar',
        close: 'Fechar',
        aToZ: 'A–Z',
        contact: 'Contato',
        contactMessage: 'Para colaborações, licenciamento ou consultas profissionais, entre em contato em',
        heroQuote: 'Curadoria dos melhores sons eletrônicos',
        nowPlaying: 'TOCANDO AGORA',
        
        // Upload form
        uploadTrack: 'Enviar Faixa',
        trackTitle: 'Título da Faixa',
        artist: 'Artista',
        featArtist: 'Artista Convidado',
        country: 'País',
        coverImage: 'Imagem da Capa',
        audioFile: 'Arquivo de Áudio (MP3)',
        chooseImage: 'Escolher Imagem',
        chooseAudio: 'Escolher Áudio',
        enterTrackTitle: 'Digite o título da faixa',
        artistName: 'Nome do artista',
        optional: 'Opcional',
        selectCountry: 'Selecione o país',
        uploadTrackBtn: 'Enviar Faixa',
        
        // Errors
        titleRequired: 'Título é obrigatório',
        artistRequired: 'Artista é obrigatório',
        countryRequired: 'País é obrigatório',
        coverRequired: 'Imagem da capa é obrigatória',
        audioRequired: 'Arquivo de áudio é obrigatório',
        selectImageFile: 'Por favor, selecione um arquivo de imagem',
        selectAudioFile: 'Por favor, selecione um arquivo de áudio',
        
        // Catalog
        noTracksAvailable: 'Nenhuma faixa disponível',
        
        // Shows
        upcoming: 'Próximos',
        past: 'Passados',
        noShowsScheduled: 'Nenhum show agendado',
        
        // Dashboard
        dashboardAccess: 'Acesso ao Painel',
        enterPassword: 'Digite a senha',
        enter: 'Entrar',
        incorrectPassword: 'Senha incorreta',
        dashboard: 'Painel',
        uploadTracks: 'Enviar Faixas',
        manageCatalog: 'Gerenciar Catálogo',
        showsCalendar: 'Calendário de Shows',
        tracks: 'faixas',
        track: 'faixa',
        shows: 'Shows',
        show: 'show',
        refresh: 'Atualizar',
        edit: 'Editar',
        delete: 'Excluir',
        saveChanges: 'Salvar Alterações',
        cancel: 'Cancelar',
        addShow: 'Adicionar Show',
        date: 'Data',
        city: 'Cidade',
        venue: 'Local',
        link: 'Link (Opcional)',
        enterCity: 'Digite a cidade',
        enterVenue: 'Digite o nome do local',
        addShowBtn: 'Adicionar Show',
        deleteShow: 'Excluir show',
        showDeleted: 'Show excluído com sucesso',
        showAdded: 'Show adicionado com sucesso',
        trackUploaded: 'Faixa enviada com sucesso',
        trackDeleted: 'Faixa excluída com sucesso',
        trackUpdated: 'Faixa atualizada com sucesso',
        pleaseFillRequired: 'Por favor, preencha todos os campos obrigatórios',
        trackNotFound: 'Faixa não encontrada',
        errorSaving: 'Erro ao salvar faixa. localStorage pode estar cheio.',
        errorDeleting: 'Erro ao excluir faixa',
        errorUpdating: 'Erro ao atualizar faixa',
        errorLoading: 'Erro ao carregar faixas',
        noTracks: 'Nenhuma faixa disponível',
        loadingTracks: 'Carregando faixas...',
        loadingShows: 'Carregando shows...',
        errorLoadingShows: 'Erro ao carregar shows',
        noShows: 'Nenhum show agendado',
        coverPreview: 'Prévia da Capa',
        changeImage: 'Alterar Imagem'
    }
};

let currentLanguage = 'en';

function getLanguage() {
    try {
        const stored = localStorage.getItem('language');
        if (stored && (stored === 'en' || stored === 'pt')) {
            return stored;
        }
    } catch (error) {
        console.error('Error loading language:', error);
    }
    return 'en';
}

function setLanguage(lang) {
    if (lang !== 'en' && lang !== 'pt') return;
    currentLanguage = lang;
    try {
        localStorage.setItem('language', lang);
    } catch (error) {
        console.error('Error saving language:', error);
    }
    document.documentElement.lang = lang;
    translatePage();
}

function t(key) {
    return translations[currentLanguage][key] || translations.en[key] || key;
}

function translatePage() {
    const elements = document.querySelectorAll('[data-translate]');
    elements.forEach(el => {
        const key = el.getAttribute('data-translate');
        if (key) {
            if (el.tagName === 'INPUT' && (el.type === 'submit' || el.type === 'button')) {
                el.value = t(key);
            } else if (el.tagName === 'BUTTON') {
                el.textContent = t(key);
            } else if (el.tagName === 'INPUT' && el.placeholder) {
                el.placeholder = t(key);
            } else if (el.tagName === 'LABEL') {
                const text = t(key);
                if (el.textContent.includes('*')) {
                    el.textContent = text + ' *';
                } else {
                    el.textContent = text;
                }
            } else {
                el.textContent = t(key);
            }
        }
    });
    
    const placeholders = document.querySelectorAll('[data-translate-placeholder]');
    placeholders.forEach(el => {
        const key = el.getAttribute('data-translate-placeholder');
        if (key) {
            el.placeholder = t(key);
        }
    });
    
    const options = document.querySelectorAll('[data-translate-option]');
    options.forEach(el => {
        const key = el.getAttribute('data-translate-option');
        if (key && el.value === '') {
            el.textContent = t(key);
        }
    });
    
    // Update language switcher active state
    if (typeof updateLangSwitcher === 'function') {
        updateLangSwitcher(currentLanguage);
    }
    
    if (typeof window.onLanguageChange === 'function') {
        window.onLanguageChange();
    }
}

window.onLanguageChange = function() {
    if (typeof buildCatalog === 'function') {
        buildCatalog();
    }
    if (typeof buildShows === 'function') {
        buildShows();
    }
};

function initLanguage() {
    const stored = getLanguage();
    // Default to EN if no language stored
    currentLanguage = stored || 'en';
    if (!localStorage.getItem('language')) {
        localStorage.setItem('language', 'en');
    }
    document.documentElement.lang = currentLanguage;
    translatePage();
}
